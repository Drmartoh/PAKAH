{% extends 'base.html' %}

{% block extra_css %}
<style>
    :root {
        --primary-orange: #FCA311;
        --primary-blue: #4A90E2;
        --primary-black: #000000;
        --primary-green: #28a745;
        --primary-white: #FFFFFF;
        --light-blue: #E8F4F8;
        --dark-blue: #2C5F8D;
        --blueish: #6BA3D8;
    }
    
    .hero-section {
        background: linear-gradient(135deg, var(--primary-orange) 0%, #ff8c00 25%, var(--primary-blue) 75%, var(--dark-blue) 100%);
        background-size: 200% 200%;
        animation: gradientShift 15s ease infinite;
        min-height: 90vh;
        display: flex;
        align-items: center;
        position: relative;
        overflow: hidden;
        padding: 80px 0;
    }
    
    @keyframes gradientShift {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
    }
    
    .hero-section::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url('data:image/svg+xml,<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><defs><pattern id="grid" width="100" height="100" patternUnits="userSpaceOnUse"><path d="M 100 0 L 0 0 0 100" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="1"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
        opacity: 0.3;
        animation: patternMove 20s linear infinite;
    }
    
    @keyframes patternMove {
        0% { transform: translate(0, 0); }
        100% { transform: translate(100px, 100px); }
    }
    
    .hero-section::after {
        content: '';
        position: absolute;
        top: -50%;
        right: -10%;
        width: 600px;
        height: 600px;
        background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
        border-radius: 50%;
        animation: pulse 8s ease-in-out infinite;
    }
    
    @keyframes pulse {
        0%, 100% { transform: scale(1); opacity: 0.5; }
        50% { transform: scale(1.2); opacity: 0.3; }
    }
    
    .hero-content {
        position: relative;
        z-index: 2;
        animation: fadeInUp 1s ease-out;
    }
    
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    .hero-badges {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
        margin-bottom: 2rem;
        animation: fadeInUp 1s ease-out 0.2s both;
    }
    
    .hero-badge {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        color: var(--primary-black);
        padding: 0.6rem 1.5rem;
        border-radius: 50px;
        font-weight: 700;
        font-size: 0.95rem;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        box-shadow: 0 4px 15px rgba(0,0,0,0.15);
        transition: all 0.3s ease;
        border: 2px solid rgba(255,255,255,0.3);
    }
    
    .hero-badge:hover {
        transform: translateY(-3px) scale(1.05);
        box-shadow: 0 6px 20px rgba(0,0,0,0.2);
        background: white;
    }
    
    .hero-badge i {
        font-size: 1.1rem;
        color: var(--primary-orange);
    }
    
    .hero-badge.affordable i { color: #28a745; }
    .hero-badge.reliable i { color: var(--primary-blue); }
    .hero-badge.fast i { color: var(--primary-orange); }
    
    .hero-title {
        font-size: 4rem;
        font-weight: 900;
        line-height: 1.1;
        margin-bottom: 1.5rem;
        color: white;
        text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
        letter-spacing: -1px;
        animation: fadeInUp 1s ease-out 0.3s both;
    }
    
    .hero-title .highlight {
        background: linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.7) 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        display: inline-block;
        position: relative;
    }
    
    .hero-subtitle {
        font-size: 1.4rem;
        color: rgba(255,255,255,0.98);
        margin-bottom: 2.5rem;
        font-weight: 400;
        line-height: 1.6;
        max-width: 600px;
        text-shadow: 1px 1px 3px rgba(0,0,0,0.2);
        animation: fadeInUp 1s ease-out 0.4s both;
    }
    
    .hero-cta-group {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
        animation: fadeInUp 1s ease-out 0.5s both;
    }
    
    .cta-button {
        background: var(--primary-black);
        color: white;
        padding: 1.1rem 2.8rem;
        font-size: 1.15rem;
        font-weight: 700;
        border-radius: 50px;
        border: 3px solid rgba(255,255,255,0.2);
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        box-shadow: 0 6px 20px rgba(0,0,0,0.3), 0 0 0 0 rgba(0,0,0,0.2);
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        position: relative;
        overflow: hidden;
    }
    
    .cta-button::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        border-radius: 50%;
        background: rgba(255,255,255,0.2);
        transform: translate(-50%, -50%);
        transition: width 0.6s, height 0.6s;
    }
    
    .cta-button:hover::before {
        width: 300px;
        height: 300px;
    }
    
    .cta-button:hover {
        transform: translateY(-4px) scale(1.05);
        box-shadow: 0 10px 30px rgba(0,0,0,0.4), 0 0 0 4px rgba(255,255,255,0.1);
        background: #1a1a1a;
        color: white;
        border-color: rgba(255,255,255,0.4);
    }
    
    .cta-button:active {
        transform: translateY(-2px) scale(1.02);
    }
    
    .cta-button i {
        transition: transform 0.3s ease;
    }
    
    .cta-button:hover i {
        transform: translateX(5px);
    }
    
    .book-now-button {
        background: var(--primary-green);
        color: white;
        padding: 1.1rem 2.8rem;
        font-size: 1.15rem;
        font-weight: 700;
        border-radius: 50px;
        border: 3px solid rgba(255,255,255,0.2);
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        box-shadow: 0 6px 20px rgba(40, 167, 69, 0.3), 0 0 0 0 rgba(40, 167, 69, 0.2);
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        cursor: pointer;
        position: relative;
        overflow: hidden;
    }
    
    .book-now-button::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        border-radius: 50%;
        background: rgba(255,255,255,0.2);
        transform: translate(-50%, -50%);
        transition: width 0.6s, height 0.6s;
    }
    
    .book-now-button:hover::before {
        width: 300px;
        height: 300px;
    }
    
    .book-now-button:hover {
        transform: translateY(-4px) scale(1.05);
        box-shadow: 0 10px 30px rgba(40, 167, 69, 0.4), 0 0 0 4px rgba(255,255,255,0.1);
        background: #218838;
        color: white;
        border-color: rgba(255,255,255,0.4);
    }
    
    .book-now-button:active {
        transform: translateY(-2px) scale(1.02);
    }
    
    .book-now-button i {
        transition: transform 0.3s ease;
    }
    
    .book-now-button:hover i {
        transform: rotate(15deg) scale(1.1);
    }
    
    .floating-icon {
        position: absolute;
        opacity: 0.15;
        animation: float 8s ease-in-out infinite;
        z-index: 1;
        filter: drop-shadow(0 4px 8px rgba(0,0,0,0.1));
    }
    
    .floating-icon:nth-child(1) {
        top: 10%;
        right: 10%;
        animation-delay: 0s;
        font-size: 180px !important;
    }
    
    .floating-icon:nth-child(2) {
        bottom: 20%;
        left: 5%;
        animation-delay: 2s;
        font-size: 140px !important;
    }
    
    .floating-icon:nth-child(3) {
        top: 50%;
        right: 5%;
        animation-delay: 4s;
        font-size: 120px !important;
    }
    
    .floating-icon:nth-child(4) {
        bottom: 10%;
        right: 20%;
        animation-delay: 1s;
        font-size: 100px !important;
    }
    
    @keyframes float {
        0%, 100% { 
            transform: translateY(0px) rotate(0deg); 
        }
        25% { 
            transform: translateY(-15px) rotate(5deg); 
        }
        50% { 
            transform: translateY(-25px) rotate(0deg); 
        }
        75% { 
            transform: translateY(-15px) rotate(-5deg); 
        }
    }
    
    .pricing-section {
        padding: 80px 0;
        background: var(--light-blue);
    }
    
    .pricing-card {
        background: white;
        border-radius: 20px;
        padding: 3rem 2rem;
        text-align: center;
        box-shadow: 0 10px 30px rgba(0,0,0,0.08);
        transition: all 0.3s ease;
        border: 2px solid transparent;
    }
    
    .pricing-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 15px 40px rgba(0,0,0,0.12);
        border-color: var(--primary-orange);
    }
    
    .pricing-amount {
        font-size: 3rem;
        font-weight: 800;
        color: var(--primary-orange);
        margin: 1rem 0;
    }
    
    .pricing-label {
        font-size: 1.1rem;
        color: #666;
        margin-bottom: 1.5rem;
    }
    
    /* Our Services section */
    .services-section {
        padding: 80px 0;
        background: white;
    }
    .services-section .section-badge {
        display: inline-block;
        background: linear-gradient(135deg, var(--primary-orange) 0%, var(--primary-blue) 100%);
        color: white;
        padding: 0.4rem 1rem;
        border-radius: 50px;
        font-size: 0.85rem;
        font-weight: 600;
        margin-bottom: 1rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
    .service-card {
        background: #fff;
        border-radius: 20px;
        padding: 2.5rem 2rem;
        height: 100%;
        box-shadow: 0 8px 30px rgba(0,0,0,0.06);
        border: 2px solid transparent;
        transition: all 0.35s ease;
        position: relative;
        overflow: hidden;
    }
    .service-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, var(--primary-orange), var(--primary-blue));
        transform: scaleX(0);
        transition: transform 0.35s ease;
    }
    .service-card:hover {
        transform: translateY(-8px);
        box-shadow: 0 16px 40px rgba(0,0,0,0.1);
        border-color: rgba(252, 163, 17, 0.3);
    }
    .service-card:hover::before {
        transform: scaleX(1);
    }
    .service-icon {
        width: 70px;
        height: 70px;
        background: linear-gradient(135deg, var(--primary-orange) 0%, var(--primary-blue) 100%);
        color: white;
        border-radius: 16px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.8rem;
        margin-bottom: 1.5rem;
    }
    .service-card h3 {
        font-size: 1.35rem;
        font-weight: 700;
        color: var(--primary-black);
        margin-bottom: 1rem;
    }
    .service-card p {
        color: #555;
        font-size: 1rem;
        line-height: 1.65;
        margin: 0;
    }
    
    /* Partnership section */
    .partnership-section {
        padding: 80px 0;
        background: linear-gradient(180deg, #f8f9fa 0%, #fff 100%);
    }
    .partnership-card {
        background: white;
        border-radius: 20px;
        padding: 2.5rem;
        box-shadow: 0 8px 30px rgba(0,0,0,0.06);
        border-left: 5px solid var(--primary-orange);
        height: 100%;
        transition: all 0.3s ease;
    }
    .partnership-card:hover {
        box-shadow: 0 12px 40px rgba(0,0,0,0.08);
        transform: translateX(5px);
    }
    .partnership-icon {
        font-size: 2.5rem;
        color: var(--primary-orange);
        margin-bottom: 1rem;
    }
    
    /* Last Mile Process section */
    .lastmile-section {
        padding: 80px 0;
        background: linear-gradient(135deg, var(--dark-blue) 0%, var(--blueish) 100%);
        color: white;
    }
    .lastmile-section .section-title {
        color: white;
        font-weight: 800;
        margin-bottom: 0.5rem;
    }
    .lastmile-section .section-subtitle {
        color: rgba(255,255,255,0.85);
        font-size: 1.15rem;
        margin-bottom: 3rem;
    }
    .lastmile-step {
        background: rgba(255,255,255,0.12);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 2rem 1.5rem;
        height: 100%;
        border: 1px solid rgba(255,255,255,0.2);
        transition: all 0.3s ease;
    }
    .lastmile-step:hover {
        background: rgba(255,255,255,0.18);
        transform: translateY(-5px);
    }
    .lastmile-step-num {
        width: 50px;
        height: 50px;
        background: var(--primary-orange);
        color: var(--primary-black);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 800;
        font-size: 1.25rem;
        margin-bottom: 1.25rem;
    }
    .lastmile-step h4 {
        font-size: 1.2rem;
        font-weight: 700;
        margin-bottom: 0.75rem;
        color: white;
    }
    .lastmile-step p {
        color: rgba(255,255,255,0.9);
        font-size: 0.95rem;
        line-height: 1.6;
        margin: 0;
    }
    
    .simple-steps {
        padding: 80px 0;
        background: white;
    }
    
    .step-number {
        width: 60px;
        height: 60px;
        background: linear-gradient(135deg, var(--primary-orange) 0%, var(--primary-blue) 100%);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        font-weight: bold;
        margin: 0 auto 1.5rem;
    }
    
    .step-card {
        text-align: center;
        padding: 2rem;
    }
    
    .step-title {
        font-size: 1.3rem;
        font-weight: 600;
        margin-bottom: 1rem;
        color: var(--primary-black);
    }
    
    .step-description {
        color: #666;
        font-size: 1rem;
    }
    
    .contact-section {
        padding: 80px 0;
        background: linear-gradient(135deg, var(--dark-blue) 0%, var(--blueish) 100%);
        color: white;
    }
    
    .contact-card {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        border-radius: 15px;
        padding: 2rem;
        margin-bottom: 1.5rem;
        border: 1px solid rgba(255, 255, 255, 0.2);
        transition: all 0.3s ease;
        height: 100%;
    }
    
    .contact-card:hover {
        background: rgba(255, 255, 255, 0.15);
        transform: translateY(-5px);
    }
    
    .contact-icon {
        font-size: 2.5rem;
        color: var(--primary-orange);
        margin-bottom: 1rem;
    }
    
    .contact-title {
        font-size: 1.2rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
    }
    
    .contact-info {
        font-size: 1rem;
        opacity: 0.9;
        line-height: 1.6;
    }
    
    #officeMap {
        height: 200px;
        width: 100%;
        border-radius: 10px;
        margin-top: 1rem;
        background: rgba(255,255,255,0.1);
    }
    
    /* Anchor scroll offset for fixed navbar */
    #services, #last-mile, #partners {
        scroll-margin-top: 90px;
    }
    
    @media (max-width: 768px) {
        .hero-section {
            min-height: 85vh;
            padding: 60px 0;
        }
        .hero-title {
            font-size: 2.5rem;
            line-height: 1.2;
        }
        .hero-subtitle {
            font-size: 1.15rem;
        }
        .hero-badges {
            gap: 0.75rem;
        }
        .hero-badge {
            font-size: 0.85rem;
            padding: 0.5rem 1.2rem;
        }
        .cta-button, .book-now-button {
            width: 100%;
            justify-content: center;
            padding: 1rem 2rem;
            font-size: 1rem;
        }
        .hero-cta-group {
            flex-direction: column;
        }
        .floating-icon {
            opacity: 0.08;
        }
        .floating-icon:nth-child(1) {
            font-size: 120px !important;
        }
        .floating-icon:nth-child(2) {
            font-size: 100px !important;
        }
        .floating-icon:nth-child(3) {
            font-size: 80px !important;
        }
        .floating-icon:nth-child(4) {
            font-size: 70px !important;
        }
        #services, #last-mile, #partners {
            scroll-margin-top: 80px;
        }
    }
    
    @media (max-width: 576px) {
        .hero-title {
            font-size: 2rem;
        }
        .hero-subtitle {
            font-size: 1rem;
        }
        .hero-badge {
            font-size: 0.8rem;
            padding: 0.45rem 1rem;
        }
    }
</style>
{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section">
    <div class="floating-icon">
        <i class="fas fa-box"></i>
    </div>
    <div class="floating-icon">
        <i class="fas fa-truck"></i>
    </div>
    <div class="floating-icon">
        <i class="fas fa-shipping-fast"></i>
    </div>
    <div class="floating-icon">
        <i class="fas fa-map-marked-alt"></i>
    </div>
    
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-8 hero-content">
                <!-- Value Proposition Badges -->
                <div class="hero-badges">
                    <div class="hero-badge affordable">
                        <i class="fas fa-money-bill-wave"></i>
                        <span>Affordable</span>
                    </div>
                    <div class="hero-badge reliable">
                        <i class="fas fa-shield-alt"></i>
                        <span>Reliable</span>
                    </div>
                    <div class="hero-badge fast">
                        <i class="fas fa-bolt"></i>
                        <span>Fast</span>
                    </div>
                </div>
                
                <!-- Main Hero Title -->
                <h1 class="hero-title">
                    <span class="highlight">Fast, Reliable &amp; Affordable</span><br>
                    Parcel Delivery Across Kenya
                </h1>
                
                <!-- Hero Subtitle -->
                <p class="hero-subtitle">
                    Experience seamless door-to-door delivery with real-time tracking. From KES 150 within Nairobi, we deliver your parcels safely and on time. Pay securely with M-Pesa and track every step of the journey.
                </p>
                
                <!-- Call-to-Action Buttons -->
                <div class="hero-cta-group">
                    {% if not user.is_authenticated %}
                    <a href="#" class="cta-button" data-bs-toggle="modal" data-bs-target="#signupModal">
                        Get Started <i class="fas fa-arrow-right"></i>
                    </a>
                    <button class="book-now-button" onclick="handleBookNow()">
                        <i class="fas fa-calendar-check"></i> Book Now
                    </button>
                    {% else %}
                    <a href="/dashboard/" class="cta-button">
                        Go to Dashboard <i class="fas fa-arrow-right"></i>
                    </a>
                    <button class="book-now-button" onclick="openOrderForm()">
                        <i class="fas fa-calendar-check"></i> Book Now
                    </button>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Our Services -->
<section class="services-section" id="services">
    <div class="container">
        <div class="text-center mb-5">
            <span class="section-badge">What We Offer</span>
            <h2 class="mb-3" style="font-size: 2.5rem; font-weight: 800; color: var(--primary-black);">Our Services</h2>
            <p class="mx-auto" style="max-width: 600px; color: #555; font-size: 1.1rem;">Professional parcel delivery solutions tailored for individuals and businesses across Kenya.</p>
        </div>
        <div class="row g-4">
            <div class="col-md-4">
                <div class="service-card">
                    <div class="service-icon"><i class="fas fa-door-open"></i></div>
                    <h3>Door to Door Parcel Delivery</h3>
                    <p>We collect your parcel from your doorstep and deliver it directly to your recipient’s address. No depot visits—we handle pickup and delivery for you.</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="service-card">
                    <div class="service-icon"><i class="fas fa-map-marked-alt"></i></div>
                    <h3>Last Mile Parcel Delivery</h3>
                    <p>We complete the final leg of delivery from our partner depots or Saccos right to the exact destination—apartment, office, or gate—with real-time tracking.</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="service-card">
                    <div class="service-icon"><i class="fas fa-gift"></i></div>
                    <h3>Special Parcel Delivery</h3>
                    <p>Handling for fragile, high-value, or time-sensitive parcels with extra care. Ideal for documents, gifts, and items requiring white-glove service.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Simple Steps -->
<section class="simple-steps">
    <div class="container">
        <h2 class="text-center mb-5" style="font-size: 2.5rem; font-weight: 700; color: var(--primary-black);">How It Works</h2>
        <div class="row">
            <div class="col-md-4 step-card">
                <div class="step-number">1</div>
                <h3 class="step-title">Place Order</h3>
                <p class="step-description">Enter pickup and drop-off locations. We calculate the price instantly.</p>
            </div>
            <div class="col-md-4 step-card">
                <div class="step-number">2</div>
                <h3 class="step-title">Pay Securely</h3>
                <p class="step-description">Pay via M-Pesa with one tap. Fast and secure payment processing.</p>
            </div>
            <div class="col-md-4 step-card">
                <div class="step-number">3</div>
                <h3 class="step-title">Track & Receive</h3>
                <p class="step-description">Watch your parcel in real-time. Get notified when it arrives.</p>
            </div>
        </div>
    </div>
</section>

<!-- Last Mile Delivery Process -->
<section class="lastmile-section" id="last-mile">
    <div class="container">
        <div class="text-center mb-5">
            <span class="section-badge" style="background: rgba(255,255,255,0.2); color: white;">Process</span>
            <h2 class="section-title" style="font-size: 2.5rem;">How Last Mile Delivery Works</h2>
            <p class="section-subtitle">We deliver your parcel from our partner depot to the exact destination—doorstep, apartment, or office.</p>
        </div>
        <div class="row g-4">
            <div class="col-md-6 col-lg-3">
                <div class="lastmile-step">
                    <div class="lastmile-step-num">1</div>
                    <h4>Mark for PAKA HOME</h4>
                    <p>The client indicates on the parcel that it will be under the care of <strong>PAKA HOME Parcel Delivery</strong> for last mile delivery—until it reaches the exact location (e.g. apartment number, office, or gate).</p>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div class="lastmile-step">
                    <div class="lastmile-step-num">2</div>
                    <h4>Driver Assigned</h4>
                    <p>PAKA HOME assigns a driver to pick up the parcel as soon as it arrives at the Sacco or parcel delivery office, ensuring no delay between arrival and handover.</p>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div class="lastmile-step">
                    <div class="lastmile-step-num">3</div>
                    <h4>You Get Notified</h4>
                    <p>The client is notified and receives a tracking number to monitor the parcel online in real time from pickup to delivery.</p>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div class="lastmile-step">
                    <div class="lastmile-step-num">4</div>
                    <h4>Exact Destination Delivery</h4>
                    <p>The cargo is delivered to the exact destination by PAKA HOME—right to the door, apartment, or specified address—with confirmation to the client.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Partnership -->
<section class="partnership-section" id="partners">
    <div class="container">
        <div class="text-center mb-5">
            <span class="section-badge">Partnership</span>
            <h2 class="mb-3" style="font-size: 2.5rem; font-weight: 800; color: var(--primary-black);">Trusted Last Mile Partner</h2>
            <p class="mx-auto" style="max-width: 700px; color: #555; font-size: 1.1rem;">We have partnered with several parcel delivery Saccos and companies. We handle <strong>Last Mile Door to Door Delivery</strong> on their behalf—from depot to your exact address.</p>
        </div>
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="partnership-card">
                    <div class="partnership-icon"><i class="fas fa-handshake"></i></div>
                    <h3 style="font-weight: 700; color: var(--primary-black); margin-bottom: 1rem;">Last Mile Delivery on Behalf of Partners</h3>
                    <p class="mb-0" style="color: #555; font-size: 1.05rem; line-height: 1.7;">When parcels arrive at our partners’ depots or offices, PAKA HOME takes over. We assign a driver, notify the client with a tracking number, and deliver the parcel to the exact destination—apartment, office, or gate. This partnership allows Saccos and parcel companies to offer true door-to-door service while we specialize in the final, customer-facing leg of delivery.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Pricing -->
<section class="pricing-section">
    <div class="container">
        <h2 class="text-center mb-5" style="font-size: 2.5rem; font-weight: 700; color: var(--primary-black);">Simple Pricing</h2>
        <div class="row justify-content-center">
            <div class="col-md-5 mb-4">
                <div class="pricing-card">
                    <h3 style="font-weight: 600; margin-bottom: 1rem; color: var(--primary-black);">Within Nairobi</h3>
                    <div class="pricing-amount">KES 150</div>
                    <p class="pricing-label">Fixed rate for all deliveries</p>
                </div>
            </div>
            <div class="col-md-5 mb-4">
                <div class="pricing-card">
                    <h3 style="font-weight: 600; margin-bottom: 1rem; color: var(--primary-black);">Nationwide</h3>
                    <div class="pricing-amount">KES 300</div>
                    <p class="pricing-label">Fixed rate for all deliveries</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Contact Information -->
<section class="contact-section">
    <div class="container">
        <h2 class="text-center mb-5" style="font-size: 2.5rem; font-weight: 700;">Contact Us</h2>
        <div class="row">
            <div class="col-md-4">
                <div class="contact-card text-center">
                    <div class="contact-icon">
                        <i class="fas fa-phone"></i>
                    </div>
                    <div class="contact-title">Call Us</div>
                    <div class="contact-info">0792-044-622</div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="contact-card text-center">
                    <div class="contact-icon">
                        <i class="fas fa-mobile-alt"></i>
                    </div>
                    <div class="contact-title">M-Pesa Till</div>
                    <div class="contact-info">{{ MPESA_TILL_NUMBER|default:"K217328" }}</div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="contact-card text-center">
                    <div class="contact-icon">
                        <i class="fas fa-map-marker-alt"></i>
                    </div>
                    <div class="contact-title">Location</div>
                    <div class="contact-info">Nairobi CBD, Mfangano Street<br>Ndaragwa Hse, Mezanine MF22</div>
                    <div id="officeMap"></div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Order Form Modal (for authenticated users) -->
{% if user.is_authenticated %}
<div class="modal fade" id="orderFormModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header" style="background: linear-gradient(135deg, var(--primary-orange) 0%, var(--primary-blue) 100%); color: white;">
                <h5 class="modal-title"><i class="fas fa-box"></i> Book Your Delivery</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body" style="padding: 2rem;">
                <form id="quickOrderForm">
                    <div class="row mb-3">
                        <div class="col-12">
                            <h5 style="color: var(--primary-orange); font-weight: 700; margin-bottom: 1.5rem;">
                                <i class="fas fa-map-marker-alt"></i> Pickup Details
                            </h5>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Pickup Name</label>
                            <input type="text" class="form-control" name="pickup_name" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Pickup Phone</label>
                            <input type="tel" class="form-control" name="pickup_phone" required>
                        </div>
                        <div class="col-12 mb-3">
                            <label class="form-label">Pickup Address <small class="text-muted">(Start typing to see suggestions)</small></label>
                            <input type="text" class="form-control" id="pickupAddressQuick" name="pickup_address" required autocomplete="off">
                            <input type="hidden" id="pickupLatQuick" name="pickup_latitude">
                            <input type="hidden" id="pickupLngQuick" name="pickup_longitude">
                        </div>
                    </div>
                    
                    <hr style="margin: 2rem 0;">
                    
                    <div class="row mb-3">
                        <div class="col-12">
                            <h5 style="color: var(--primary-blue); font-weight: 700; margin-bottom: 1.5rem;">
                                <i class="fas fa-truck"></i> Drop-off Details
                            </h5>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Drop-off Name</label>
                            <input type="text" class="form-control" name="delivery_name" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Drop-off Phone</label>
                            <input type="tel" class="form-control" name="delivery_phone" required>
                        </div>
                        <div class="col-12 mb-3">
                            <label class="form-label">Drop-off Address <small class="text-muted">(Start typing to see suggestions)</small></label>
                            <input type="text" class="form-control" id="deliveryAddressQuick" name="delivery_address" required autocomplete="off">
                            <input type="hidden" id="deliveryLatQuick" name="delivery_latitude">
                            <input type="hidden" id="deliveryLngQuick" name="delivery_longitude">
                        </div>
                    </div>
                    
                    <div class="price-display" style="background: linear-gradient(135deg, var(--primary-orange) 0%, var(--primary-blue) 100%); color: white; padding: 1.5rem; border-radius: 15px; text-align: center; margin: 1.5rem 0;">
                        <h5 style="margin: 0; font-size: 1.2rem; font-weight: 600;">Estimated Price</h5>
                        <div class="amount" id="estimatedPriceQuick" style="font-size: 2rem; font-weight: 800; margin-top: 0.5rem;">KES 0</div>
                    </div>
                    
                    <button type="submit" class="btn w-100" style="background: var(--primary-black); color: white; padding: 1rem; border-radius: 10px; font-weight: 600; font-size: 1.1rem;">
                        <i class="fas fa-check"></i> Create Order
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endif %}

{% endblock %}

{% block extra_js %}
<script>
    const GOOGLE_MAPS_API_KEY = '{{ GOOGLE_MAPS_API_KEY|default:"" }}';
    let pickupAutocompleteQuick, deliveryAutocompleteQuick;
    let officeMap;
    let mapsLoaded = false;
    
    // Request location permission
    function requestLocationPermission() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(
                function(position) {
                    console.log('Location permission granted');
                },
                function(error) {
                    console.warn('Location permission denied:', error);
                }
            );
        }
    }
    
    // Request location on page load
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
            function() { console.log('Location access granted'); },
            function() { console.log('Location access denied or unavailable'); }
        );
    }
    
    // Load Google Maps with callback
    function loadGoogleMaps() {
        if (mapsLoaded || typeof google !== 'undefined') {
            initMaps();
            return;
        }
        
        const script = document.createElement('script');
        script.src = `https://maps.googleapis.com/maps/api/js?key=${GOOGLE_MAPS_API_KEY}&libraries=places,geometry&loading=async&callback=initMaps`;
        script.async = true;
        script.defer = true;
        script.onerror = function() {
            console.error('Failed to load Google Maps');
        };
        document.head.appendChild(script);
    }
    
    // Initialize maps when Google Maps loads
    window.initMaps = function() {
        mapsLoaded = true;
        console.log('Google Maps loaded successfully');
        initOfficeMap();
        initQuickOrderAutocomplete();
    };
    
    // Initialize Office Location Map
    function initOfficeMap() {
        if (!mapsLoaded || typeof google === 'undefined' || !google.maps) {
            return;
        }
        
        const officeMapElement = document.getElementById('officeMap');
        if (!officeMapElement) return;
        
        const officeLocation = {
            lat: {{ OFFICE_LATITUDE|default:-1.2921 }},
            lng: {{ OFFICE_LONGITUDE|default:36.8219 }}
        };
        
        officeMap = new google.maps.Map(officeMapElement, {
            center: officeLocation,
            zoom: 16,
            mapTypeControl: false,
            streetViewControl: false,
            fullscreenControl: false
        });
        
        const marker = new google.maps.Marker({
            position: officeLocation,
            map: officeMap,
            title: 'PAKA HOME Office',
            icon: {
                url: 'https://maps.google.com/mapfiles/ms/icons/orange-dot.png'
            }
        });
        
        const infoWindow = new google.maps.InfoWindow({
            content: '<div style="padding: 10px;"><strong>PAKA HOME</strong><br>{{ OFFICE_ADDRESS|default:"Nairobi CBD, Mfangano Street, Ndaragwa Hse, Mezanine MF22" }}</div>'
        });
        
        marker.addListener('click', function() {
            infoWindow.open(officeMap, marker);
        });
        
        infoWindow.open(officeMap, marker);
    }
    
    // Initialize Google Maps Autocomplete for quick order form
    function initQuickOrderAutocomplete() {
        if (!mapsLoaded || typeof google === 'undefined' || !google.maps || !google.maps.places) {
            console.log('Maps not ready, retrying...');
            setTimeout(initQuickOrderAutocomplete, 100);
            return;
        }
        
        {% if user.is_authenticated %}
        const pickupInput = document.getElementById('pickupAddressQuick');
        const deliveryInput = document.getElementById('deliveryAddressQuick');
        
        if (!pickupInput || !deliveryInput) {
            console.log('Input fields not found, waiting...');
            return;
        }
        
        // Check if inputs are visible (modal is open)
        if (pickupInput.offsetParent === null || deliveryInput.offsetParent === null) {
            console.log('Input fields not visible (modal closed), will initialize when modal opens');
            return;
        }
        
        // Clear existing listeners
        if (pickupAutocompleteQuick) {
            google.maps.event.clearInstanceListeners(pickupInput);
            pickupAutocompleteQuick = null;
        }
        if (deliveryAutocompleteQuick) {
            google.maps.event.clearInstanceListeners(deliveryInput);
            deliveryAutocompleteQuick = null;
        }
        
        try {
            console.log('Initializing autocomplete for pickup and delivery fields...');
            
            pickupAutocompleteQuick = new google.maps.places.Autocomplete(pickupInput, {
                componentRestrictions: { country: 'ke' },
                fields: ['geometry', 'formatted_address', 'name', 'place_id'],
                types: ['address']
            });
            
            deliveryAutocompleteQuick = new google.maps.places.Autocomplete(deliveryInput, {
                componentRestrictions: { country: 'ke' },
                fields: ['geometry', 'formatted_address', 'name', 'place_id'],
                types: ['address']
            });
            
            pickupAutocompleteQuick.addListener('place_changed', function() {
                const place = pickupAutocompleteQuick.getPlace();
                console.log('Pickup place selected:', place);
                if (place.geometry) {
                    // Round to 6 decimal places
                    const lat = parseFloat(place.geometry.location.lat().toFixed(6));
                    const lng = parseFloat(place.geometry.location.lng().toFixed(6));
                    document.getElementById('pickupLatQuick').value = lat;
                    document.getElementById('pickupLngQuick').value = lng;
                    console.log('Pickup coordinates:', lat, lng);
                    calculateQuickPrice();
                } else {
                    console.warn('No geometry found for pickup place');
                }
            });
            
            deliveryAutocompleteQuick.addListener('place_changed', function() {
                const place = deliveryAutocompleteQuick.getPlace();
                console.log('Delivery place selected:', place);
                if (place.geometry) {
                    // Round to 6 decimal places
                    const lat = parseFloat(place.geometry.location.lat().toFixed(6));
                    const lng = parseFloat(place.geometry.location.lng().toFixed(6));
                    document.getElementById('deliveryLatQuick').value = lat;
                    document.getElementById('deliveryLngQuick').value = lng;
                    console.log('Delivery coordinates:', lat, lng);
                    calculateQuickPrice();
                } else {
                    console.warn('No geometry found for delivery place');
                }
            });
            
            console.log('Quick order autocomplete initialized successfully');
        } catch (error) {
            console.error('Error initializing autocomplete:', error);
            alert('Failed to initialize address autocomplete. Please refresh the page.');
        }
        {% endif %}
    }
    
    function calculateQuickPrice() {
        const pickupLat = parseFloat(document.getElementById('pickupLatQuick')?.value);
        const pickupLng = parseFloat(document.getElementById('pickupLngQuick')?.value);
        const deliveryLat = parseFloat(document.getElementById('deliveryLatQuick')?.value);
        const deliveryLng = parseFloat(document.getElementById('deliveryLngQuick')?.value);
        
        if (isNaN(pickupLat) || isNaN(pickupLng) || isNaN(deliveryLat) || isNaN(deliveryLng)) {
            const priceElement = document.getElementById('estimatedPriceQuick');
            if (priceElement) {
                priceElement.textContent = 'KES 0';
            }
            return;
        }
        
        const nairobiBounds = {
            minLat: -1.5, maxLat: -1.1,
            minLng: 36.6, maxLng: 37.0
        };
        
        const pickupInNairobi = (
            pickupLat >= nairobiBounds.minLat && 
            pickupLat <= nairobiBounds.maxLat &&
            pickupLng >= nairobiBounds.minLng && 
            pickupLng <= nairobiBounds.maxLng
        );
        
        const deliveryInNairobi = (
            deliveryLat >= nairobiBounds.minLat && 
            deliveryLat <= nairobiBounds.maxLat &&
            deliveryLng >= nairobiBounds.minLng && 
            deliveryLng <= nairobiBounds.maxLng
        );
        
        const price = (pickupInNairobi && deliveryInNairobi) ? 150 : 300;
        const priceElement = document.getElementById('estimatedPriceQuick');
        if (priceElement) {
            priceElement.textContent = `KES ${price}`;
        }
    }
    
    function handleBookNow() {
        {% if user.is_authenticated %}
        openOrderForm();
        {% else %}
        // Show signup modal for non-authenticated users with friendly message
        const signupModal = new bootstrap.Modal(document.getElementById('signupModal'));
        signupModal.show();
        setTimeout(() => {
            // Optional: Show a helpful message
            console.log('Please sign up to book a delivery');
        }, 300);
        {% endif %}
    }
    
    function openOrderForm() {
        {% if user.is_authenticated %}
        const orderModalElement = document.getElementById('orderFormModal');
        if (!orderModalElement) {
            console.error('Order form modal not found');
            alert('Order form not available. Please refresh the page.');
            return;
        }
        const orderModal = new bootstrap.Modal(orderModalElement);
        orderModal.show();
        console.log('Opening order form modal...');
        // Wait for modal animation and input fields to be visible
        setTimeout(function() {
            if (mapsLoaded) {
                initQuickOrderAutocomplete();
            } else {
                const checkMaps = setInterval(function() {
                    if (mapsLoaded) {
                        clearInterval(checkMaps);
                        initQuickOrderAutocomplete();
                    }
                }, 100);
                // Timeout after 5 seconds
                setTimeout(function() {
                    clearInterval(checkMaps);
                }, 5000);
            }
        }, 500);
        {% else %}
        // Redirect to login for non-authenticated users
        const loginModal = new bootstrap.Modal(document.getElementById('loginModal'));
        loginModal.show();
        setTimeout(() => {
            console.log('Please sign in to book a delivery');
        }, 300);
        {% endif %}
    }
    
    // Handle quick order form submission
    {% if user.is_authenticated %}
    document.addEventListener('DOMContentLoaded', function() {
        const quickOrderForm = document.getElementById('quickOrderForm');
        if (quickOrderForm) {
            quickOrderForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const formData = new FormData(e.target);
                const data = Object.fromEntries(formData);
                
                // Convert coordinates to numbers and round to 6 decimal places
                if (data.pickup_latitude) data.pickup_latitude = parseFloat(parseFloat(data.pickup_latitude).toFixed(6));
                if (data.pickup_longitude) data.pickup_longitude = parseFloat(parseFloat(data.pickup_longitude).toFixed(6));
                if (data.delivery_latitude) data.delivery_latitude = parseFloat(parseFloat(data.delivery_latitude).toFixed(6));
                if (data.delivery_longitude) data.delivery_longitude = parseFloat(parseFloat(data.delivery_longitude).toFixed(6));
                
                // Validate coordinates
                if (!data.pickup_latitude || !data.pickup_longitude) {
                    alert('Please select a valid pickup address from the suggestions.');
                    return;
                }
                
                if (!data.delivery_latitude || !data.delivery_longitude) {
                    alert('Please select a valid delivery address from the suggestions.');
                    return;
                }
                
                try {
                    // Get CSRF token (function is in base.html)
                    const csrftoken = getCookie('csrftoken');
                    
                    const response = await fetch('/api/orders/', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': csrftoken || ''
                        },
                        credentials: 'include',
                        body: JSON.stringify(data)
                    });
                    
                    const result = await response.json();
                    if (response.ok) {
                        alert('Order created successfully! Redirecting to dashboard...');
                        bootstrap.Modal.getInstance(document.getElementById('orderFormModal')).hide();
                        window.location.href = '/dashboard/';
                    } else {
                        const errorMsg = result.error || result.detail || Object.values(result).flat().join(', ') || 'Failed to create order';
                        alert(errorMsg);
                    }
                } catch (error) {
                    console.error('Error creating order:', error);
                    alert('An error occurred. Please try again.');
                }
            });
        }
        
        // Initialize autocomplete when modal opens
        const orderModal = document.getElementById('orderFormModal');
        if (orderModal) {
            orderModal.addEventListener('shown.bs.modal', function() {
                console.log('Order modal opened, initializing autocomplete...');
                // Wait for modal animation and input fields to be visible
                setTimeout(function() {
                    if (mapsLoaded) {
                        initQuickOrderAutocomplete();
                    } else {
                        // Wait for maps to load
                        const checkMaps = setInterval(function() {
                            if (mapsLoaded) {
                                clearInterval(checkMaps);
                                initQuickOrderAutocomplete();
                            }
                        }, 100);
                        // Timeout after 5 seconds
                        setTimeout(function() {
                            clearInterval(checkMaps);
                        }, 5000);
                    }
                }, 500);
            });
        }
    });
    {% endif %}
    
    // Initialize when page loads
    document.addEventListener('DOMContentLoaded', function() {
        loadGoogleMaps();
        requestLocationPermission();
    });
</script>
{% endblock %}
